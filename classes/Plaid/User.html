<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <title>Plaid::User</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <link rel="stylesheet" href="../../css/reset.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../css/main.css" type="text/css" media="screen" />
<link rel="stylesheet" href="../../css/github.css" type="text/css" media="screen" />
<script src="../../js/jquery-1.3.2.min.js" type="text/javascript" charset="utf-8"></script>
<script src="../../js/jquery-effect.js" type="text/javascript" charset="utf-8"></script>
<script src="../../js/main.js" type="text/javascript" charset="utf-8"></script>
<script src="../../js/highlight.pack.js" type="text/javascript" charset="utf-8"></script>

</head>

<body>
    <div class="banner">
        
        <h1>
            <span class="type">Class</span>
            Plaid::User
            
                <span class="parent">&lt;
                    
                    Object
                    
                </span>
            
        </h1>
        <ul class="files">
            
            <li><a href="../../files/lib/plaid/user_rb.html">lib/plaid/user.rb</a></li>
            
        </ul>
    </div>
    <div id="bodyContent">
        <div id="content">
  
    <div class="description">
      
<p>A class which encapsulates the authenticated user for all <a
href="../Plaid.html">Plaid</a> products.</p>

    </div>
  


  


  
  
    <!-- Sections -->
    <div class="sectiontitle">Sections</div>
    <ul>
      
        <li><a href="#Internal">Internal</a></li>
      
        <li><a href="#Public">Public</a></li>
      
    </ul>
  


  


  
    <!-- Method ref -->
    <div class="sectiontitle">Methods</div>
    <dl class="methods">
      
        <dt>A</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-auth">auth</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>B</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-balance">balance</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>C</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-create">create</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>D</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-delete">delete</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>E</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-exchange_token">exchange_token</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>F</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-for_product">for_product</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>I</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-income">income</a>,
              </li>
            
              
              <li>
                <a href="#method-i-info">info</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>L</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-load">load</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>M</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-mfa-3F">mfa?</a>,
              </li>
            
              
              <li>
                <a href="#method-i-mfa_step">mfa_step</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>N</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-c-new">new</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>R</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-risk">risk</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>T</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-transactions">transactions</a>
              </li>
            
          </ul>
        </dd>
      
        <dt>U</dt>
        <dd>
          <ul>
            
              
              <li>
                <a href="#method-i-update">update</a>,
              </li>
            
              
              <li>
                <a href="#method-i-update_webhook">update_webhook</a>,
              </li>
            
              
              <li>
                <a href="#method-i-upgrade">upgrade</a>
              </li>
            
          </ul>
        </dd>
      
    </dl>
  

  



  

    

    

    


    


    <!-- Methods -->
              

    
      <div class="contenttitle" id="Public">
        Public
      </div>
    

    

    


    
      <!-- Section attributes -->
      <div class="sectiontitle">Attributes</div>
      <table border='0' cellpadding='5'>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>access_token</td>
            <td class='attr-desc'><p>The access token for authenticated user.</p></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>accounts</td>
            <td class='attr-desc'><p>The Array of <a href="Account.html">Account</a> instances providing
accounts information for the user.</p></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>initial_transactions</td>
            <td class='attr-desc'><p>The Array of Transactions provided by initial call to <a
href="User.html#method-c-create">::create</a>.</p>

<p>If the :login_only option of <a
href="User.html#method-c-create">::create</a> is set to false, the initial
30-day transactional data are returned during the API call. This attribute
contains them.</p></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>mfa</td>
            <td class='attr-desc'><p>The MFA data (Hash or Array of Hash) or nil, if no MFA required.</p>

<p>E.g. [{ question: “What was the name of your first pet?” }] or [{ mask:
&#39;t..t@plaid.com&#39;, type: &#39;email&#39; }, { mask:
&#39;xxx-xxx-5309&#39;,   type: &#39;phone&#39; }] or { message: &#39;Code
sent to xxx-xxx-5309&#39; }</p></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>mfa_type</td>
            <td class='attr-desc'><p>The Symbol MFA type to be used (or nil, if no MFA required).</p>

<p>E.g. :questions, :list, or :device.</p></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>processor_token</td>
            <td class='attr-desc'><p>The processor token for a given account and authenticated user.</p></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>product</td>
            <td class='attr-desc'><p>The current product. Provides a context for <a
href="User.html#method-i-update">update</a> and <a
href="User.html#method-i-delete">delete</a> calls. See Plaid::PRODUCTS.</p></td>
          </tr>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>stripe_bank_account_token</td>
            <td class='attr-desc'><p>The String stripe bank account token.</p>

<p>This field is set when you use <a
href="User.html#method-c-exchange_token">::exchange_token</a> to convert
Link public_token into an access token suitable for <a
href="../Plaid.html">Plaid</a> API.</p></td>
          </tr>
        
      </table>
    


    <!-- Methods -->
    
      <div class="sectiontitle">Class Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-c-create">
            
              <b>create</b>(product, institution, username, password, pin: nil, options: nil, client: nil)
            
            <a href="../../classes/Plaid/User.html#method-c-create" name="method-c-create" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Create (add) a user.</p>
<dl class="rdoc-list note-list"><dt>product
<dd>
<p>The Symbol product name you are adding the user to, one of Plaid::PRODUCTS
(e.g. :info, :connect, etc.).</p>
</dd><dt>institution
<dd>
<p>The String/Symbol financial institution type that you want to access (e.g.
:wells).</p>
</dd><dt>username
<dd>
<p>The String username associated with the financial institution.</p>
</dd><dt>password
<dd>
<p>The String password associated with the financial institution.</p>
</dd><dt>pin
<dd>
<p>The String PIN number associated with the financial institution (default:
nil).</p>
</dd><dt>options
<dd>
<p>the Hash options (default: {}):</p>
<dl class="rdoc-list note-list"><dt>:list
<dd>
<p>The Boolean flag which would request the available send methods if the
institution requires code-based MFA credential (default: false).</p>
</dd><dt>:webhook
<dd>
<p>The String webhook URL. Used with :connect, :income, and :risk products
(default: nil).</p>
</dd><dt>:pending
<dd>
<p>The Boolean flag requesting to return pending transactions. Used with
:connect product (default: false).</p>
</dd><dt>:login_only
<dd>
<p>The Boolean option valid for initial authentication only. If set to false,
the initial request will return transaction data based on the start_date
and end_date.</p>
</dd><dt>:start_date
<dd>
<p>The start Date from which to return transactions (default: 30 days ago).</p>
</dd><dt>:end_date
<dd>
<p>The end Date to which transactions will be collected (default: today).</p>
</dd></dl>
</dd><dt>client
<dd>
<p>The <a href="Client.html">Plaid::Client</a> instance used to connect to the
API (default is to use global <a href="../Plaid.html">Plaid</a> client - <a
href="../Plaid.html#attribute-c-client">Plaid.client</a>).</p>
</dd></dl>

<h3 id="method-c-create-label-Returns">Returns</h3>

<p>Returns a <a href="User.html">Plaid::User</a> instance.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-c-create_source')" id="l_method-c-create_source">show</a>
                
              </p>
              <div id="method-c-create_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/plaid/user.rb, line 86</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">self</span>.<span class="ruby-identifier">create</span>(<span class="ruby-identifier">product</span>, <span class="ruby-identifier">institution</span>, <span class="ruby-identifier">username</span>, <span class="ruby-identifier">password</span>,
                <span class="ruby-identifier">pin</span><span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">options</span><span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">client</span><span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">check_product</span> <span class="ruby-identifier">product</span>

  <span class="ruby-identifier">payload</span> = { <span class="ruby-identifier">username</span><span class="ruby-operator">:</span> <span class="ruby-identifier">username</span>, <span class="ruby-identifier">password</span><span class="ruby-operator">:</span> <span class="ruby-identifier">password</span>,
              <span class="ruby-identifier">type</span><span class="ruby-operator">:</span> <span class="ruby-identifier">institution</span>.<span class="ruby-identifier">to_s</span> }
  <span class="ruby-identifier">payload</span>[<span class="ruby-value">:pin</span>] = <span class="ruby-identifier">pin</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">pin</span>
  <span class="ruby-identifier">payload</span>[<span class="ruby-value">:options</span>] = <span class="ruby-constant">MultiJson</span>.<span class="ruby-identifier">dump</span>(<span class="ruby-identifier">options</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span>

  <span class="ruby-identifier">conn</span> = <span class="ruby-constant">Connector</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">product</span>, <span class="ruby-identifier">auth</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>, <span class="ruby-identifier">client</span><span class="ruby-operator">:</span> <span class="ruby-identifier">client</span>)
  <span class="ruby-identifier">resp</span> = <span class="ruby-identifier">conn</span>.<span class="ruby-identifier">post</span>(<span class="ruby-identifier">payload</span>)

  <span class="ruby-identifier">new</span> <span class="ruby-identifier">product</span>, <span class="ruby-identifier">response</span><span class="ruby-operator">:</span> <span class="ruby-identifier">resp</span>, <span class="ruby-identifier">mfa</span><span class="ruby-operator">:</span> <span class="ruby-identifier">conn</span>.<span class="ruby-identifier">mfa?</span>, <span class="ruby-identifier">client</span><span class="ruby-operator">:</span> <span class="ruby-identifier">client</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-exchange_token">
            
              <b>exchange_token</b>(public_token, account_id = nil, product: :connect, client: nil)
            
            <a href="../../classes/Plaid/User.html#method-c-exchange_token" name="method-c-exchange_token" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Exchange a Link public_token for an API access_token.</p>

<p>The account_id parameter is required if you wish to receive a Stripe bank
account token.</p>
<dl class="rdoc-list note-list"><dt>public_token
<dd>
<p>The String Link public_token.</p>
</dd><dt>account_id
<dd>
<p>The String account ID.</p>
</dd><dt>product
<dd>
<p>The Symbol product name (default: :connect).</p>
</dd><dt>client
<dd>
<p>The <a href="Client.html">Plaid::Client</a> instance used to connect to the
API (default is to use global <a href="../Plaid.html">Plaid</a> client - <a
href="../Plaid.html#attribute-c-client">Plaid.client</a>).</p>
</dd></dl>

<h3 id="method-c-exchange_token-label-Returns">Returns</h3>

<p>Returns a new <a href="User.html">User</a> with access token obtained from
<a href="../Plaid.html">Plaid</a> and default product set to product. <a
href="User.html#attribute-i-stripe_bank_account_token">#stripe_bank_account_token</a>
for this user instance will contain the Stripe token.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-c-exchange_token_source')" id="l_method-c-exchange_token_source">show</a>
                
              </p>
              <div id="method-c-exchange_token_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/plaid/user.rb, line 131</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">self</span>.<span class="ruby-identifier">exchange_token</span>(<span class="ruby-identifier">public_token</span>, <span class="ruby-identifier">account_id</span> = <span class="ruby-keyword">nil</span>,
                        <span class="ruby-identifier">product</span><span class="ruby-operator">:</span> <span class="ruby-value">:connect</span>, <span class="ruby-identifier">client</span><span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">check_product</span> <span class="ruby-identifier">product</span>

  <span class="ruby-identifier">payload</span> = { <span class="ruby-identifier">public_token</span><span class="ruby-operator">:</span> <span class="ruby-identifier">public_token</span> }
  <span class="ruby-identifier">payload</span>[<span class="ruby-value">:account_id</span>] = <span class="ruby-identifier">account_id</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">account_id</span>

  <span class="ruby-identifier">response</span> = <span class="ruby-constant">Connector</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:exchange_token</span>, <span class="ruby-identifier">auth</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>, <span class="ruby-identifier">client</span><span class="ruby-operator">:</span> <span class="ruby-identifier">client</span>)
                      .<span class="ruby-identifier">post</span>(<span class="ruby-identifier">payload</span>)

  <span class="ruby-identifier">stripe_token</span> = <span class="ruby-identifier">account_id</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">response</span>[<span class="ruby-string">&#39;stripe_bank_account_token&#39;</span>]
  <span class="ruby-identifier">new</span> <span class="ruby-identifier">product</span>, <span class="ruby-identifier">response</span><span class="ruby-operator">:</span> <span class="ruby-identifier">response</span>, <span class="ruby-identifier">client</span><span class="ruby-operator">:</span> <span class="ruby-identifier">client</span>,
               <span class="ruby-identifier">stripe_token</span><span class="ruby-operator">:</span> <span class="ruby-identifier">stripe_token</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-c-load">
            
              <b>load</b>(product, token, client: nil)
            
            <a href="../../classes/Plaid/User.html#method-c-load" name="method-c-load" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Get <a href="User.html">User</a> instance in case user access token is
known.</p>

<p>No requests are made, but the returned <a href="User.html">User</a>
instance is ready to be used.</p>
<dl class="rdoc-list note-list"><dt>product
<dd>
<p>The Symbol product name you want to use, one of Plaid::PRODUCTS (e.g.
:info, :connect, etc.).</p>
</dd><dt>token
<dd>
<p>The String access token for the user.</p>
</dd><dt>client
<dd>
<p>The <a href="Client.html">Plaid::Client</a> instance used to connect to the
API (default is to use global <a href="../Plaid.html">Plaid</a> client - <a
href="../Plaid.html#attribute-c-client">Plaid.client</a>).</p>
</dd></dl>

<h3 id="method-c-load-label-Returns">Returns</h3>

<p>Returns a <a href="User.html">Plaid::User</a> instance.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-c-load_source')" id="l_method-c-load_source">show</a>
                
              </p>
              <div id="method-c-load_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/plaid/user.rb, line 113</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">self</span>.<span class="ruby-identifier">load</span>(<span class="ruby-identifier">product</span>, <span class="ruby-identifier">token</span>, <span class="ruby-identifier">client</span><span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">new</span> <span class="ruby-identifier">check_product</span>(<span class="ruby-identifier">product</span>), <span class="ruby-identifier">access_token</span><span class="ruby-operator">:</span> <span class="ruby-identifier">token</span>, <span class="ruby-identifier">client</span><span class="ruby-operator">:</span> <span class="ruby-identifier">client</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
                  
      <div class="sectiontitle">Instance Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-i-auth">
            
              <b>auth</b>(sync: false)
            
            <a href="../../classes/Plaid/User.html#method-i-auth" name="method-i-auth" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Get auth information for the user (routing numbers for accounts).</p>

<p>Not only this method returns the new data, but it updates self.accounts as
well.</p>

<p>The method does a POST /auth/get request.</p>
<dl class="rdoc-list note-list"><dt>sync
<dd>
<p>The Boolean flag which, if true, causes auth information to be rerequested
from the server. Otherwise cached version is returned, if it exists.</p>
</dd></dl>

<h3 id="method-i-auth-label-Returns">Returns</h3>

<p>Returns an Array of <a href="Account.html">Account</a> with numbers baked
in.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-auth_source')" id="l_method-i-auth_source">show</a>
                
              </p>
              <div id="method-i-auth_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/plaid/user.rb, line 370</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">auth</span>(<span class="ruby-identifier">sync</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">sync</span> <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@accounts</span> <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@accounts</span>[<span class="ruby-number">0</span>] <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@accounts</span>[<span class="ruby-number">0</span>].<span class="ruby-identifier">numbers</span>
    <span class="ruby-identifier">response</span> = <span class="ruby-constant">Connector</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:auth</span>, <span class="ruby-value">:get</span>, <span class="ruby-identifier">auth</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>, <span class="ruby-identifier">client</span><span class="ruby-operator">:</span> <span class="ruby-identifier">client</span>)
                        .<span class="ruby-identifier">post</span>(<span class="ruby-identifier">access_token</span><span class="ruby-operator">:</span> <span class="ruby-identifier">access_token</span>)

    <span class="ruby-identifier">update_accounts</span>(<span class="ruby-identifier">response</span>)
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">accounts</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-balance">
            
              <b>balance</b>()
            
            <a href="../../classes/Plaid/User.html#method-i-balance" name="method-i-balance" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Get current account balance.</p>

<p>Does a POST /balance request.</p>

<h3 id="method-i-balance-label-Returns">Returns</h3>

<p>Returns an Array of <a href="Account.html">Plaid::Account</a>.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-balance_source')" id="l_method-i-balance_source">show</a>
                
              </p>
              <div id="method-i-balance_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/plaid/user.rb, line 440</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">balance</span>
  <span class="ruby-identifier">response</span> = <span class="ruby-constant">Connector</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:balance</span>, <span class="ruby-identifier">auth</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>, <span class="ruby-identifier">client</span><span class="ruby-operator">:</span> <span class="ruby-identifier">client</span>)
                      .<span class="ruby-identifier">post</span>(<span class="ruby-identifier">access_token</span><span class="ruby-operator">:</span> <span class="ruby-identifier">access_token</span>)

  <span class="ruby-identifier">update_accounts</span>(<span class="ruby-identifier">response</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-delete">
            
              <b>delete</b>()
            
            <a href="../../classes/Plaid/User.html#method-i-delete" name="method-i-delete" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Delete the user.</p>

<p>Makes a delete request and freezes self to prevent further modifications to
the object.</p>

<h3 id="method-i-delete-label-Returns">Returns</h3>

<p>Returns self.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-delete_source')" id="l_method-i-delete_source">show</a>
                
              </p>
              <div id="method-i-delete_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/plaid/user.rb, line 315</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">delete</span>
  <span class="ruby-constant">Connector</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">product</span>, <span class="ruby-identifier">auth</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>, <span class="ruby-identifier">client</span><span class="ruby-operator">:</span> <span class="ruby-identifier">client</span>)
           .<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">access_token</span><span class="ruby-operator">:</span> <span class="ruby-identifier">access_token</span>)

  <span class="ruby-identifier">freeze</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-for_product">
            
              <b>for_product</b>(product)
            
            <a href="../../classes/Plaid/User.html#method-i-for_product" name="method-i-for_product" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Get the current user tied to another product.</p>

<p>No API request is made, just the current product is changed.</p>
<dl class="rdoc-list note-list"><dt>product
<dd>
<p>The Symbol product you are selecting, one of Plaid::PRODUCTS.</p>
</dd></dl>

<p>See also <a href="User.html#method-i-upgrade">#upgrade</a>.</p>

<h3 id="method-i-for_product-label-Returns">Returns</h3>

<p>Returns a new <a href="User.html">User</a> instance.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-for_product_source')" id="l_method-i-for_product_source">show</a>
                
              </p>
              <div id="method-i-for_product_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/plaid/user.rb, line 354</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">for_product</span>(<span class="ruby-identifier">product</span>)
  <span class="ruby-constant">User</span>.<span class="ruby-identifier">load</span> <span class="ruby-identifier">product</span>, <span class="ruby-identifier">access_token</span>, <span class="ruby-identifier">client</span><span class="ruby-operator">:</span> <span class="ruby-identifier">client</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-income">
            
              <b>income</b>(sync: false)
            
            <a href="../../classes/Plaid/User.html#method-i-income" name="method-i-income" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Get income information for the user.</p>

<p>Does a POST /income/get request.</p>
<dl class="rdoc-list note-list"><dt>sync
<dd>
<p>The Boolean flag which, if true, causes income information to be
rerequested from the server. Otherwise cached version is returned, if it
exists.</p>
</dd></dl>

<h3 id="method-i-income-label-Returns">Returns</h3>

<p>Returns a <a href="Income.html">Plaid::Income</a> instance.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-income_source')" id="l_method-i-income_source">show</a>
                
              </p>
              <div id="method-i-income_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/plaid/user.rb, line 408</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">income</span>(<span class="ruby-identifier">sync</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">sync</span> <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@income</span>
    <span class="ruby-identifier">parse_response</span>(<span class="ruby-constant">Connector</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:income</span>, <span class="ruby-value">:get</span>, <span class="ruby-identifier">auth</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>, <span class="ruby-identifier">client</span><span class="ruby-operator">:</span> <span class="ruby-identifier">client</span>)
                            .<span class="ruby-identifier">post</span>(<span class="ruby-identifier">access_token</span><span class="ruby-operator">:</span> <span class="ruby-identifier">access_token</span>))
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@income</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-info">
            
              <b>info</b>(sync: false)
            
            <a href="../../classes/Plaid/User.html#method-i-info" name="method-i-info" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Get info for the user.</p>

<p>Does a POST /info/get request.</p>
<dl class="rdoc-list note-list"><dt>sync
<dd>
<p>The Boolean flag which, if true, causes information to be rerequested from
the server. Otherwise cached version is returned, if it exists.</p>
</dd></dl>

<h3 id="method-i-info-label-Returns">Returns</h3>

<p>Returns a <a href="Info.html">Plaid::Info</a> instance.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-info_source')" id="l_method-i-info_source">show</a>
                
              </p>
              <div id="method-i-info_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/plaid/user.rb, line 390</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">info</span>(<span class="ruby-identifier">sync</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">sync</span> <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@info</span>
    <span class="ruby-identifier">parse_response</span>(<span class="ruby-constant">Connector</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:info</span>, <span class="ruby-value">:get</span>, <span class="ruby-identifier">auth</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>, <span class="ruby-identifier">client</span><span class="ruby-operator">:</span> <span class="ruby-identifier">client</span>)
                            .<span class="ruby-identifier">post</span>(<span class="ruby-identifier">access_token</span><span class="ruby-operator">:</span> <span class="ruby-identifier">access_token</span>))
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@info</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-mfa-3F">
            
              <b>mfa?</b>()
            
            <a href="../../classes/Plaid/User.html#method-i-mfa-3F" name="method-i-mfa-3F" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Find out if MFA is required based on last request.</p>

<p>After calling e.g. <a href="User.html#method-c-create">::create</a> you
might need to make an additional authorization step if MFA is required by
the financial institution.</p>

<h3 id="method-i-mfa-3F-label-Returns">Returns</h3>

<p>Returns true if this step is needed, a falsey value otherwise.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-mfa-3F_source')" id="l_method-i-mfa-3F_source">show</a>
                
              </p>
              <div id="method-i-mfa-3F_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/plaid/user.rb, line 174</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">mfa?</span>
  <span class="ruby-ivar">@mfa_required</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-mfa_step">
            
              <b>mfa_step</b>(info = nil, send_method: nil, options: nil)
            
            <a href="../../classes/Plaid/User.html#method-i-mfa_step" name="method-i-mfa_step" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Submit MFA information.</p>
<dl class="rdoc-list note-list"><dt>info
<dd>
<p>The String with MFA information (default: nil).</p>
</dd><dt>send_method
<dd>
<p>The Hash with code send method information. E.g. { type: &#39;phone&#39; }
or { mask: &#39;123-…-4321&#39; }. Default is first available email.</p>
</dd><dt>options
<dd>
<p>the Hash options (default: {}):</p>
<dl class="rdoc-list note-list"><dt>:list
<dd>
<p>The Boolean flag which would request the available send methods if the
institution requires code-based MFA credential (default: false).</p>
</dd><dt>:webhook
<dd>
<p>The String webhook URL. Used with :connect, :income, and :risk products
(default: nil).</p>
</dd><dt>:pending
<dd>
<p>The Boolean flag requesting to return pending transactions. Used with
:connect product (default: false).</p>
</dd><dt>:login_only
<dd>
<p>The Boolean option valid for initial authentication only. If set to false,
the initial request will return transaction data based on the start_date
and end_date.</p>
</dd><dt>:start_date
<dd>
<p>The start Date from which to return transactions (default: 30 days ago).</p>
</dd><dt>:end_date
<dd>
<p>The end Date to which transactions will be collected (default: today).</p>
</dd></dl>
</dd></dl>

<h3 id="method-i-mfa_step-label-Returns">Returns</h3>

<p>Returns true if whole MFA process is completed, false otherwise.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-mfa_step_source')" id="l_method-i-mfa_step_source">show</a>
                
              </p>
              <div id="method-i-mfa_step_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/plaid/user.rb, line 204</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">mfa_step</span>(<span class="ruby-identifier">info</span> = <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">send_method</span><span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">options</span><span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">payload</span> = { <span class="ruby-identifier">access_token</span><span class="ruby-operator">:</span> <span class="ruby-identifier">access_token</span> }
  <span class="ruby-identifier">payload</span>[<span class="ruby-value">:mfa</span>] = <span class="ruby-identifier">info</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">info</span>
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">options</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">send_method</span>
    <span class="ruby-identifier">options</span> = {} <span class="ruby-keyword">unless</span> <span class="ruby-identifier">options</span>
    <span class="ruby-identifier">options</span>[<span class="ruby-value">:send_method</span>] = <span class="ruby-identifier">send_method</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">send_method</span>
    <span class="ruby-identifier">payload</span>[<span class="ruby-value">:options</span>] = <span class="ruby-constant">MultiJson</span>.<span class="ruby-identifier">dump</span>(<span class="ruby-identifier">options</span>)
  <span class="ruby-keyword">end</span>
  <span class="ruby-identifier">conn</span> = <span class="ruby-constant">Connector</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">product</span>, <span class="ruby-value">:step</span>, <span class="ruby-identifier">auth</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>)

  <span class="ruby-comment"># Use PATCH if we are in context of User#update.</span>
  <span class="ruby-identifier">response</span> = <span class="ruby-keyword">if</span> <span class="ruby-ivar">@mfa_patch</span>
               <span class="ruby-identifier">conn</span>.<span class="ruby-identifier">patch</span>(<span class="ruby-identifier">payload</span>)
             <span class="ruby-keyword">else</span>
               <span class="ruby-identifier">conn</span>.<span class="ruby-identifier">post</span>(<span class="ruby-identifier">payload</span>)
             <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@mfa_required</span> = <span class="ruby-identifier">conn</span>.<span class="ruby-identifier">mfa?</span>
  <span class="ruby-identifier">parse_response</span>(<span class="ruby-identifier">response</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-risk">
            
              <b>risk</b>(sync: false)
            
            <a href="../../classes/Plaid/User.html#method-i-risk" name="method-i-risk" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Get risk data for the user&#39;s accounts.</p>

<p>Does a POST /risk/get request.</p>
<dl class="rdoc-list note-list"><dt>sync
<dd>
<p>The Boolean flag which, if true, causes risk information to be rerequested
from the server. Otherwise cached version is returned, if it exists.</p>
</dd></dl>

<h3 id="method-i-risk-label-Returns">Returns</h3>

<p>Returns an Array of accounts with risk attribute set.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-risk_source')" id="l_method-i-risk_source">show</a>
                
              </p>
              <div id="method-i-risk_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/plaid/user.rb, line 426</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">risk</span>(<span class="ruby-identifier">sync</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>)
  <span class="ruby-keyword">if</span> <span class="ruby-identifier">sync</span> <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@accounts</span> <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@accounts</span>[<span class="ruby-number">0</span>] <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@accounts</span>[<span class="ruby-number">0</span>].<span class="ruby-identifier">risk</span>
    <span class="ruby-identifier">parse_response</span>(<span class="ruby-constant">Connector</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:risk</span>, <span class="ruby-value">:get</span>, <span class="ruby-identifier">auth</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>, <span class="ruby-identifier">client</span><span class="ruby-operator">:</span> <span class="ruby-identifier">client</span>)
                            .<span class="ruby-identifier">post</span>(<span class="ruby-identifier">access_token</span><span class="ruby-operator">:</span> <span class="ruby-identifier">access_token</span>))
  <span class="ruby-keyword">end</span>

  <span class="ruby-ivar">@accounts</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-transactions">
            
              <b>transactions</b>(pending: false, account_id: nil, start_date: nil, end_date: nil)
            
            <a href="../../classes/Plaid/User.html#method-i-transactions" name="method-i-transactions" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Get transactions.</p>

<p>Does a /connect/get call. Updates self.accounts with latest information.</p>
<dl class="rdoc-list note-list"><dt>pending
<dd>
<p>the Boolean flag requesting to return pending transactions.</p>
</dd><dt>account_id
<dd>
<p>the String <a href="Account.html">Account</a> ID (default: nil). If this
argument is present, only transactions for given account will be requested.</p>
</dd><dt>start_date
<dd>
<p>The start Date (inclusive).</p>
</dd><dt>end_date
<dd>
<p>The end Date (inclusive).</p>
</dd></dl>

<h3 id="method-i-transactions-label-Returns">Returns</h3>

<p>Returns an Array of <a href="Transaction.html">Transaction</a> records.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-transactions_source')" id="l_method-i-transactions_source">show</a>
                
              </p>
              <div id="method-i-transactions_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/plaid/user.rb, line 237</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">transactions</span>(<span class="ruby-identifier">pending</span><span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>, <span class="ruby-identifier">account_id</span><span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>,
                 <span class="ruby-identifier">start_date</span><span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">end_date</span><span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">options</span> = { <span class="ruby-identifier">pending</span><span class="ruby-operator">:</span> <span class="ruby-identifier">pending</span> }
  <span class="ruby-identifier">options</span>[<span class="ruby-value">:account</span>] = <span class="ruby-identifier">account_id</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">account_id</span>
  <span class="ruby-identifier">options</span>[<span class="ruby-value">:gte</span>] = <span class="ruby-identifier">start_date</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">start_date</span>
  <span class="ruby-identifier">options</span>[<span class="ruby-value">:lte</span>] = <span class="ruby-identifier">end_date</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">end_date</span>

  <span class="ruby-identifier">response</span> = <span class="ruby-constant">Connector</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:connect</span>, <span class="ruby-value">:get</span>, <span class="ruby-identifier">auth</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>, <span class="ruby-identifier">client</span><span class="ruby-operator">:</span> <span class="ruby-identifier">client</span>)
                      .<span class="ruby-identifier">post</span>(<span class="ruby-identifier">access_token</span><span class="ruby-operator">:</span> <span class="ruby-identifier">access_token</span>,
                            <span class="ruby-identifier">options</span><span class="ruby-operator">:</span> <span class="ruby-constant">MultiJson</span>.<span class="ruby-identifier">dump</span>(<span class="ruby-identifier">options</span>))
  <span class="ruby-identifier">update_accounts</span>(<span class="ruby-identifier">response</span>)
  <span class="ruby-identifier">build_objects</span>(<span class="ruby-identifier">response</span>[<span class="ruby-string">&#39;transactions&#39;</span>], <span class="ruby-constant">Transaction</span>)
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-update">
            
              <b>update</b>(username, password, pin = nil)
            
            <a href="../../classes/Plaid/User.html#method-i-update" name="method-i-update" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Update user credentials.</p>

<p>Updates the user credentials for the current product. See <a
href="User.html#method-i-for_product">#for_product</a>.</p>
<dl class="rdoc-list note-list"><dt>username
<dd>
<p>The String username associated with the financial institution.</p>
</dd><dt>password
<dd>
<p>The String password associated with the financial institution.</p>
</dd><dt>pin
<dd>
<p>The String PIN number associated with the financial institution (default:
nil).</p>
</dd></dl>

<h3 id="method-i-update-label-Returns">Returns</h3>

<p>Returns self.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-update_source')" id="l_method-i-update_source">show</a>
                
              </p>
              <div id="method-i-update_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/plaid/user.rb, line 264</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">update</span>(<span class="ruby-identifier">username</span>, <span class="ruby-identifier">password</span>, <span class="ruby-identifier">pin</span> = <span class="ruby-keyword">nil</span>)
  <span class="ruby-identifier">payload</span> = {
    <span class="ruby-identifier">access_token</span><span class="ruby-operator">:</span> <span class="ruby-identifier">access_token</span>,
    <span class="ruby-identifier">username</span><span class="ruby-operator">:</span> <span class="ruby-identifier">username</span>,
    <span class="ruby-identifier">password</span><span class="ruby-operator">:</span> <span class="ruby-identifier">password</span>
  }

  <span class="ruby-identifier">payload</span>[<span class="ruby-value">:pin</span>] = <span class="ruby-identifier">pin</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">pin</span>

  <span class="ruby-identifier">conn</span> = <span class="ruby-constant">Connector</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">product</span>, <span class="ruby-identifier">auth</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>, <span class="ruby-identifier">client</span><span class="ruby-operator">:</span> <span class="ruby-identifier">client</span>)
  <span class="ruby-identifier">resp</span> = <span class="ruby-identifier">conn</span>.<span class="ruby-identifier">patch</span>(<span class="ruby-identifier">payload</span>)

  <span class="ruby-keyword">if</span> <span class="ruby-identifier">conn</span>.<span class="ruby-identifier">mfa?</span>
    <span class="ruby-ivar">@mfa_required</span> = <span class="ruby-keyword">true</span>
  <span class="ruby-keyword">end</span>

  <span class="ruby-identifier">parse_response</span>(<span class="ruby-identifier">resp</span>)

  <span class="ruby-comment"># A note for User#mfa_step to send PATCH request too</span>
  <span class="ruby-ivar">@mfa_patch</span> = <span class="ruby-keyword">true</span>

  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-update_webhook">
            
              <b>update_webhook</b>(webhook)
            
            <a href="../../classes/Plaid/User.html#method-i-update_webhook" name="method-i-update_webhook" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Create or update the webhook for Connect.</p>

<p>Does a PATCH /connect request.</p>
<dl class="rdoc-list note-list"><dt>webhook
<dd>
<p>The String with webhook URL.</p>
</dd></dl>

<h3 id="method-i-update_webhook-label-Returns">Returns</h3>

<p>Returns self.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-update_webhook_source')" id="l_method-i-update_webhook_source">show</a>
                
              </p>
              <div id="method-i-update_webhook_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/plaid/user.rb, line 295</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">update_webhook</span>(<span class="ruby-identifier">webhook</span>)
  <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-string">&#39;User#update_webhook only supported by Connect!&#39;</span>          <span class="ruby-keyword">unless</span> <span class="ruby-identifier">product</span> <span class="ruby-operator">==</span> <span class="ruby-value">:connect</span>

  <span class="ruby-identifier">payload</span> = {
    <span class="ruby-identifier">access_token</span><span class="ruby-operator">:</span> <span class="ruby-identifier">access_token</span>,
    <span class="ruby-identifier">options</span><span class="ruby-operator">:</span> <span class="ruby-constant">MultiJson</span>.<span class="ruby-identifier">dump</span>(<span class="ruby-identifier">webhook</span><span class="ruby-operator">:</span> <span class="ruby-identifier">webhook</span>)
  }

  <span class="ruby-identifier">parse_response</span>(<span class="ruby-constant">Connector</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:connect</span>, <span class="ruby-identifier">auth</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>, <span class="ruby-identifier">client</span><span class="ruby-operator">:</span> <span class="ruby-identifier">client</span>)
                          .<span class="ruby-identifier">patch</span>(<span class="ruby-identifier">payload</span>))
  <span class="ruby-keyword">self</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
        
        <div class="method">
          <div class="title method-title" id="method-i-upgrade">
            
              <b>upgrade</b>(product)
            
            <a href="../../classes/Plaid/User.html#method-i-upgrade" name="method-i-upgrade" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Upgrade the user.</p>

<p>For an existing user that has been added via any of products (:connect,
:auth, :income, :info, or :risk), you can upgrade that user to have
functionality with other products.</p>

<p>Does a POST /upgrade request.</p>

<p>See also <a href="User.html#method-i-for_product">#for_product</a>.</p>
<dl class="rdoc-list note-list"><dt>product
<dd>
<p>The Symbol product name you are upgrading the user to, one of
Plaid::PRODUCTS.</p>
</dd></dl>

<h3 id="method-i-upgrade-label-Returns">Returns</h3>

<p>Returns another <a href="User.html">User</a> record with the same access
token, but tied to the new product.</p>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-i-upgrade_source')" id="l_method-i-upgrade_source">show</a>
                
              </p>
              <div id="method-i-upgrade_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/plaid/user.rb, line 337</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">upgrade</span>(<span class="ruby-identifier">product</span>)
  <span class="ruby-identifier">payload</span> = { <span class="ruby-identifier">access_token</span><span class="ruby-operator">:</span> <span class="ruby-identifier">access_token</span>, <span class="ruby-identifier">upgrade_to</span><span class="ruby-operator">:</span> <span class="ruby-identifier">product</span>.<span class="ruby-identifier">to_s</span> }
  <span class="ruby-identifier">response</span> = <span class="ruby-constant">Connector</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value">:upgrade</span>, <span class="ruby-identifier">auth</span><span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>, <span class="ruby-identifier">client</span><span class="ruby-operator">:</span> <span class="ruby-identifier">client</span>)
                      .<span class="ruby-identifier">post</span>(<span class="ruby-identifier">payload</span>)

  <span class="ruby-constant">User</span>.<span class="ruby-identifier">new</span> <span class="ruby-identifier">product</span>, <span class="ruby-identifier">response</span><span class="ruby-operator">:</span> <span class="ruby-identifier">response</span>, <span class="ruby-identifier">client</span><span class="ruby-operator">:</span> <span class="ruby-identifier">client</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
                    

    
      <div class="contenttitle" id="Internal">
        Internal
      </div>
    

    

    


    
      <!-- Section attributes -->
      <div class="sectiontitle">Attributes</div>
      <table border='0' cellpadding='5'>
        
          <tr valign='top'>
            <td class='attr-rw'>
              [R]
            </td>
            <td class='attr-name'>client</td>
            <td class='attr-desc'><p>The <a href="Client.html">Plaid::Client</a> instance used to make queries.</p></td>
          </tr>
        
      </table>
    


    <!-- Methods -->
    
      <div class="sectiontitle">Class Public methods</div>
      
        <div class="method">
          <div class="title method-title" id="method-c-new">
            
              <b>new</b>(product, access_token: nil, response: nil, mfa: nil, stripe_token: nil, client: nil)
            
            <a href="../../classes/Plaid/User.html#method-c-new" name="method-c-new" class="permalink">Link</a>
          </div>

          
            <div class="description">
              <p>Initialize a <a href="User.html">User</a> instance.</p>
<dl class="rdoc-list note-list"><dt>product
<dd>
<p>The Symbol product name.</p>
</dd><dt><a href="User.html#attribute-i-access_token">#access_token</a>
<dd>
<p>The String access token obtained from <a href="../Plaid.html">Plaid</a>.</p>
</dd><dt>response
<dd>
<p>The Hash response body to parse.</p>
</dd><dt>mfa
<dd>
<p>The Boolean flag indicating that response body contains an MFA response.</p>
</dd><dt>stripe_token
<dd>
<p>The String stripe bank account token.</p>
</dd><dt>client
<dd>
<p>The <a href="Client.html">Plaid::Client</a> instance used to connect to the
API (default is to use global <a href="../Plaid.html">Plaid</a> client - <a
href="../Plaid.html#attribute-c-client">Plaid.client</a>).</p>
</dd></dl>
            </div>
          

          

          

          
            
            <div class="sourcecode">
              
              <p class="source-link">
                Source:
                <a href="javascript:toggleSource('method-c-new_source')" id="l_method-c-new_source">show</a>
                
              </p>
              <div id="method-c-new_source" class="dyn-source">
                <pre><span class="ruby-comment"># File lib/plaid/user.rb, line 156</span>
<span class="ruby-keyword">def</span> <span class="ruby-keyword ruby-title">initialize</span>(<span class="ruby-identifier">product</span>, <span class="ruby-identifier">access_token</span><span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">response</span><span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">mfa</span><span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>,
               <span class="ruby-identifier">stripe_token</span><span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>, <span class="ruby-identifier">client</span><span class="ruby-operator">:</span> <span class="ruby-keyword">nil</span>)
  <span class="ruby-ivar">@product</span> = <span class="ruby-identifier">product</span>
  <span class="ruby-ivar">@client</span> = <span class="ruby-identifier">client</span>
  <span class="ruby-ivar">@access_token</span> = <span class="ruby-identifier">access_token</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">access_token</span>
  <span class="ruby-ivar">@mfa_required</span> = <span class="ruby-identifier">mfa</span>
  <span class="ruby-ivar">@stripe_bank_account_token</span> = <span class="ruby-identifier">stripe_token</span>
  <span class="ruby-ivar">@accounts</span> = <span class="ruby-ivar">@initial_transactions</span> = <span class="ruby-ivar">@info</span> = <span class="ruby-ivar">@risk</span> = <span class="ruby-ivar">@income</span> = <span class="ruby-keyword">nil</span>

  <span class="ruby-identifier">parse_response</span>(<span class="ruby-identifier">response</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">response</span>
<span class="ruby-keyword">end</span></pre>
              </div>
            </div>
            
          </div>
                        </div>

    </div>
  </body>
</html>
